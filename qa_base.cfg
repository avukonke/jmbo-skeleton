[buildout]
extensions=
    lovely.buildouthttp
parts=
    jmbodemo
    jmbodemo-supervisor-fcgi
    jmbodemo-supervisor-gunicorn
    jmbodemo-nginx-fcgi
    jmbodemo-nginx-gunicorn
    directories
    media-links
eggs=
    flup
    psycopg2
    jmbodemo
extends = 
    versions.cfg
versions = versions    
develop = .

[versions]
django = 1.3.1

[jmbodemo]
recipe = djangorecipe
project = jmbodemo
projectegg = jmbodemo
settings = settings_XXX
eggs = ${buildout:eggs}
settings = settings_qa_XXX
control-script = jmbodemo-qa-XXX

[jmbodemo-supervisor-fcgi]
recipe = collective.recipe.template
input = buildout_templates/supervisor.fcgi.in
output = ${buildout:directory}/supervisor/fcgi-jmbodemo-qa-XXX.conf
name = jmbodemo-qa-XXX
control-script = jmbodemo-qa-XXX
host = 127.0.0.1
port = XXX
user = www-data
log=${buildout:directory}/log/process.log

[jmbodemo-supervisor-gunicorn]
recipe = collective.recipe.template
input = buildout_templates/supervisor.gunicorn.in
output = ${buildout:directory}/supervisor/gunicorn-jmbodemo-qa-XXX.conf
name = jmbodemo-qa-XXX
control-script = jmbodemo-qa-XXX
host = 127.0.0.1
port = XXX
workers = 2
max-requests = 10000
user = www-data
log=${buildout:directory}/log/process.log

[jmbodemo-nginx-fcgi]
recipe = collective.recipe.template
input = buildout_templates/nginx.fcgi.conf.in
output = ${buildout:directory}/nginx/fcgi-jmbodemo-qa-XXX.conf
server-name = XXX
port = 80
fcgi-host = ${jmbodemo-supervisor-fcgi:host}
fcgi-port = ${jmbodemo-supervisor-fcgi:port}
media-root = ${buildout:directory}/../media-qa
static-root = ${buildout:directory}/static
downloads-root = downloads

[jmbodemo-nginx-gunicorn]
recipe = collective.recipe.template
input = buildout_templates/nginx.gunicorn.conf.in
output = ${buildout:directory}/nginx/gunicorn-jmbodemo-qa-XXX.conf
server-name = XXX
port = 80
gunicorn-host = ${jmbodemo-supervisor-gunicorn:host}
gunicorn-port = ${jmbodemo-supervisor-gunicorn:port}
media-root = ${buildout:directory}/../media-qa
static-root = ${buildout:directory}/static
downloads-root = downloads

[directories]
recipe = z3c.recipe.mkdir
paths = 
    ../media-qa/uploads
    ../media-qa/downloads
    log

[media-links]
recipe = svetlyak40wt.recipe.symlinks
path = ${buildout:directory}/../media-qa
files =
    ${buildout:directory}/src/django-ckeditor/ckeditor/media/ckeditor
