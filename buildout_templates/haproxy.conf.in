frontend devproxy
    bind *:${port-prefix}00
    mode http
    default_backend devproxy-switcher

backend devproxy-switcher
    server devproxy-1 ${host}:${port-prefix}01 weight 1 check maxconn 500
    server devproxy-2 ${host}:${port-prefix}02 weight 1 check maxconn 500
    server devproxy-3 ${host}:${port-prefix}03 weight 1 check maxconn 500
    server devproxy-4 ${host}:${port-prefix}04 weight 1 check maxconn 500

frontend devproxy-upstream
    bind *:${port-prefix}09
    mode http
    # high, smart are device-proxy default names. Jmbo uses smart and basic.
    acl is_smart hdr_sub(X-UA-map) high
    acl is_basic hdr_sub(X-UA-map) medium
    use_backend smart-backend if is_smart
    use_backend basic-backend if is_basic
    default_backend basic-backend

backend basic-backend
    server basic-backend-1 ${host}:${port-prefix}21 weight 1 check maxconn 500
    server basic-backend-2 ${host}:${port-prefix}22 weight 1 check maxconn 500
    server basic-backend-3 ${host}:${port-prefix}23 weight 1 check maxconn 500
    server basic-backend-4 ${host}:${port-prefix}24 weight 1 check maxconn 500

backend smart-backend
    server smart-backend-1 ${host}:${port-prefix}31 weight 1 check maxconn 500
    server smart-backend-2 ${host}:${port-prefix}32 weight 1 check maxconn 500
    server smart-backend-3 ${host}:${port-prefix}33 weight 1 check maxconn 500
    server smart-backend-4 ${host}:${port-prefix}34 weight 1 check maxconn 500



